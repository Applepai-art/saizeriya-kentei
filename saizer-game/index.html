<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>ã‚µã‚¤ã‚¼ãƒªãƒ¤æ¤œå®š</title>
  <style>
    * { box-sizing: border-box; }
    body {
      margin: 0;
      padding: 0;
      font-family: system-ui, "M PLUS Rounded 1c", sans-serif;
      background: linear-gradient(135deg,#ffe9c7,#ffd6e8);
      min-height: 100vh;
      display: flex;
      align-items: center;
      justify-content: center;
    }
    .wrapper { width: 100%; max-width: 480px; padding: 16px; }

    .card {
      background: #fffdf7;
      border-radius: 18px;
      box-shadow: 0 10px 25px rgba(0,0,0,0.12);
      padding: 22px 18px;
      text-align: center;
      border: 2px solid #ffe2a9;
      position: relative;
      overflow: hidden;
    }
    .card::before {
      content:"";
      position:absolute;
      inset:-40px;
      background-image:
        radial-gradient(circle at 10% 20%, rgba(255,221,153,.3) 0, transparent 55%),
        radial-gradient(circle at 80% 0, rgba(255,204,230,.4) 0, transparent 55%);
      opacity:.6;
      z-index:-1;
    }

    .hidden { display:none; }

    .logo-title {
      display: inline-block;
      padding: 12px 18px;
      border: 4px solid #008e3a;
      border-radius: 16px;
      margin-bottom: 14px;
      background: #ffffffcc;
    }
    .logo-title span {
      font-size: 2.0rem;
      font-weight: 900;
      letter-spacing: .14em;
      color: #e60012;
      -webkit-text-stroke: 6px #ffffff;
      paint-order: stroke fill;
    }

    .subtitle {
      margin: 0 0 18px;
      color: #555;
      font-size: .95rem;
    }

    .btn {
      display:inline-block;
      padding:10px 20px;
      border-radius:999px;
      border:none;
      cursor:pointer;
      font-weight:600;
      transition:.1s ease;
      margin:6px;
      font-size:.95rem;
    }
    .btn-primary {
      background:#ff8a5c; color:#fff; box-shadow:0 4px 0 #d76a3e;
    }
    .btn-primary:hover { background:#ff9b74; transform:translateY(-1px); }
    .btn-primary:active { transform:translateY(1px); box-shadow:0 2px 0 #d76a3e; }

    .btn-outline {
      background:#fff; color:#ff8a5c; border:2px solid #ffb88c;
      box-shadow:0 2px 0 #e6a06e;
    }
    .btn-outline:hover { background:#fff8f3; transform:translateY(-1px); }
    .btn-outline:active { transform:translateY(1px); box-shadow:0 1px 0 #e6a06e; }

    .hint {
      margin-top: 10px;
      font-size: 0.8rem;
      color: #777;
    }

    .timer-wrap {
      margin-bottom: 10px;
      text-align: left;
      font-size: 0.85rem;
      color: #666;
    }
    .timer-top {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 4px;
    }
    .timer-label {
      font-weight: 600;
      display: flex;
      align-items: center;
      gap: 4px;
    }
    .timer-value {
      font-family: "Roboto Mono", monospace;
      font-weight: 700;
    }
    .timer-bar {
      width: 100%;
      height: 8px;
      border-radius: 999px;
      background: #ffe3cc;
      overflow: hidden;
    }
    #timeBarInner {
      height: 100%;
      width: 100%;
      border-radius: 999px;
      background: linear-gradient(90deg,#1b9b5f,#ffcf4d);
      transition: width 0.2s linear;
    }

    #question {
      font-size:1.25rem; font-weight:700;
      background:#fff;
      border-radius:10px;
      border:1px dashed #ffd38a;
      padding:8px 10px; margin-bottom:8px;
    }

    #modeLabel {
      display:inline-block;
      padding:3px 10px;
      border-radius:999px;
      background:#fff3d4;
      border:1px solid #ffb55b;
      font-size:0.8rem;
      color:#7a3d00;
      margin-bottom:4px;
    }

    #modeDetail {
      margin: 0 0 10px;
      font-size: 0.8rem;
      color: #666;
    }

    .combo-text {
      min-height: 1.2em;
      font-weight: 800;
      color: #ff8a5c;
      margin-bottom: 6px;
      font-size: 0.95rem;
    }

    .input-row {
      display:flex;
      justify-content:center;
      align-items:center;
      gap:8px;
      margin-bottom:8px;
    }

    input[type=number] {
      text-align:center;
      font-size:1.1rem;
      padding:6px 10px;
      border-radius:999px;
      border:2px solid #ffbf69;
      outline:none;
      background:#fffdf8;
      transition:.15s;
    }
    input[type=number]:focus {
      border-color:#ff8a5c;
      box-shadow:0 0 0 3px rgba(255,172,120,.35);
    }

    #result {
      margin-top:4px;
      min-height:1.4em;
      font-weight:700;
      font-size:.98rem;
    }
    #result.correct { color:#1b9b5f; }
    #result.wrong { color:#d64545; }

    .score-row {
      margin-top: 12px;
      display:flex;
      justify-content:space-around;
      flex-wrap:wrap;
      gap:8px;
    }
    .score-pill {
      background:#fff7dd;
      border:1px solid #ffd58c;
      border-radius:999px;
      padding:6px 10px;
      font-size:.9rem;
      min-width:120px;
    }
    .score-pill-label { color:#666; font-size:.8rem; }
    .score-pill-value { font-weight:700; margin-left:4px; }

    .quiz-footer {
      margin-top: 12px;
      display:flex;
      justify-content:space-between;
      flex-wrap:wrap;
      gap:8px;
    }

    .pop { animation: pop 0.25s ease-out; }
    @keyframes pop {
      0% { transform:scale(.95); }
      50% { transform:scale(1.05); }
      100% { transform:scale(1); }
    }
    .shake { animation: shake 0.25s ease-out; }
    @keyframes shake {
      0%,100%{ transform:translateX(0); }
      25%{ transform:translateX(-4px); }
      75%{ transform:translateX(4px); }
    }

    .star-overlay {
      pointer-events:none;
      position:fixed;
      inset:0;
      display:flex;
      justify-content:center;
      align-items:center;
      opacity:0;
      transition:opacity .2s;
      z-index:999;
    }
    .star-overlay.show {
      opacity:1;
    }
    .star {
      font-size:2.4rem;
      color:#ffd54f;
      text-shadow:0 0 10px rgba(255,215,0,0.8);
      animation: floatUp .6s ease-out forwards;
      margin:0 .15em;
    }
    @keyframes floatUp {
      0% { transform:translateY(10px) scale(.8); opacity:0; }
      30% { opacity:1; }
      100% { transform:translateY(-40px) scale(1.1); opacity:0; }
    }

    #quizScreen.flash-red {
      animation: flashRed .35s ease-out;
    }
    @keyframes flashRed {
      0%   { box-shadow:0 0 0 0 rgba(255,0,0,.4); }
      50%  { box-shadow:0 0 0 8px rgba(255,0,0,.25); }
      100% { box-shadow:0 0 0 0 rgba(255,0,0,0); }
    }

    .memory-table-wrap {
      border:1px solid #ffd58c;
      border-radius:10px;
      background:#fff;
      max-height:260px;
      overflow:auto;
      margin-top:10px;
      text-align:left;
    }
    table { width:100%; border-collapse:collapse; font-size:.85rem; }
    thead th {
      background:#fff3d4;
      padding:6px;
      color:#7a5a24;
      font-size:.75rem;
      position:sticky;
      top:0;
      z-index:1;
    }
    td {
      padding:6px 8px;
      border-bottom:1px solid #f3e3c2;
    }
    tbody tr:nth-child(even){ background:#fffdf4; }

    .category-row td {
      background:#ffe9c7;
      color:#7a3d00;
      font-weight:700;
      border-bottom:1px solid #f3e3c2;
      padding-top:8px;
    }

    .rank-badge {
      display:inline-block;
      padding:8px 16px;
      border-radius:999px;
      background:#fff3d4;
      border:2px solid #ffb55b;
      margin-bottom:6px;
      font-weight:700;
      color:#7a3d00;
    }
    .rank-title {
      font-size:1.4rem;
      font-weight:900;
      margin:4px 0;
      color:#e60012;
    }
    .rank-desc {
      font-size:.9rem;
      color:#555;
      margin-bottom:10px;
    }
    .result-stats {
      text-align:left;
      font-size:.9rem;
      margin:0 auto 10px;
      max-width:260px;
    }
    .result-stats div {
      display:flex;
      justify-content:space-between;
      margin:3px 0;
    }
    .share-hint {
      margin-top:6px;
      font-size:0.8rem;
      color:#888;
    }

    @media (max-width: 480px) {
      .card { padding:18px 14px; }
      .logo-title span { font-size:1.7rem; letter-spacing:.12em; }
      #question { font-size:1.1rem; }
      .rank-title { font-size:1.25rem; }
    }
  </style>
</head>
<body>
  <div class="wrapper">

    <!-- ãƒˆãƒƒãƒ—ç”»é¢ -->
    <div class="card" id="homeScreen">
      <div class="logo-title">
        <span>ã‚µã‚¤ã‚¼ãƒªãƒ¤æ¤œå®š</span>
      </div>

      <p class="subtitle">ã‚µã‚¤ã‚¼ã®ãƒ¡ãƒ‹ãƒ¥ãƒ¼ç•ªå·ã€ã©ã“ã¾ã§è¦šãˆã¦ã‚‹ï¼Ÿ</p>

      <button class="btn btn-primary" onclick="setModeAndGo('normal')">
        ğŸ æ™®é€šãƒ¢ãƒ¼ãƒ‰ã§æ¤œå®š
      </button>
      <button class="btn btn-outline" onclick="setModeAndGo('hard')">
        ğŸ”¥ é›£é–¢ãƒ¢ãƒ¼ãƒ‰ã§æ¤œå®š
      </button>

      <button class="btn btn-outline" onclick="showScreen('memoryScreen')">
        ğŸ“– æš—è¨˜ãƒšãƒ¼ã‚¸
      </button>

      <div class="hint">
        æ™®é€šãƒ¢ãƒ¼ãƒ‰ï¼šãƒˆãƒƒãƒ”ãƒ³ã‚°ã‚„ãƒ¯ã‚¤ãƒ³ä»¥å¤–ã®å®šç•ªãƒ¡ãƒ‹ãƒ¥ãƒ¼ã‹ã‚‰å‡ºé¡Œã€‚<br>
        é›£é–¢ãƒ¢ãƒ¼ãƒ‰ï¼šå…¨ãƒ¡ãƒ‹ãƒ¥ãƒ¼ï¼ˆãŠé…’ãƒ»ãƒˆãƒƒãƒ”ãƒ³ã‚°å«ã‚€ï¼‰ã‹ã‚‰å‡ºé¡Œã€‚
      </div>
    </div>

    <!-- ã‚¯ã‚¤ã‚ºç”»é¢ -->
    <div class="card hidden" id="quizScreen">
      <h2>æ¤œå®š æœ¬ç•ª</h2>
      <div id="modeLabel">æ™®é€šãƒ¢ãƒ¼ãƒ‰</div>
      <p id="modeDetail"></p>
      <p class="subtitle">60ç§’é–“ã§ä½•å•æ­£è§£ã§ãã‚‹ã‹å‹è² ï¼</p>

      <div class="timer-wrap">
        <div class="timer-top">
          <div class="timer-label">â± æ®‹ã‚Šæ™‚é–“</div>
          <div class="timer-value" id="timeText">60 ç§’</div>
        </div>
        <div class="timer-bar">
          <div id="timeBarInner"></div>
        </div>
      </div>

      <div id="quizReady">
        <p class="subtitle" style="margin-bottom:12px;">
          ã€Œã‚¹ã‚¿ãƒ¼ãƒˆã€ã‚’æŠ¼ã™ã¨ã‚«ã‚¦ãƒ³ãƒˆãƒ€ã‚¦ãƒ³ãŒå§‹ã¾ã‚Šã¾ã™ã€‚<br>
          å‡ºã¦ããŸãƒ¡ãƒ‹ãƒ¥ãƒ¼ã®æ³¨æ–‡ç•ªå·ã‚’å…¥åŠ›ã—ã‚ˆã†ï¼
        </p>
        <button class="btn btn-primary" id="startQuizBtn">â–¶ ã‚¹ã‚¿ãƒ¼ãƒˆ</button>
        <button class="btn btn-outline" onclick="showScreen('homeScreen')">â¬… ãƒˆãƒƒãƒ—ã¸</button>
      </div>

      <div id="quizPlay" class="hidden">
        <div id="question">ãƒ­ãƒ¼ãƒ‰ä¸­...</div>

        <div id="comboText" class="combo-text"></div>

        <div class="input-row">
          <input id="answerInput" type="number" placeholder="ç•ªå·" />
          <button class="btn btn-primary" id="submitBtn">æ±ºå®šï¼</button>
        </div>

        <div id="result"></div>

        <div class="score-row">
          <div class="score-pill">
            <span class="score-pill-label">æ­£è§£æ•°</span>
            <span class="score-pill-value" id="score">0</span>
          </div>
          <div class="score-pill">
            <span class="score-pill-label">ãƒã‚¤ã‚¹ã‚³ã‚¢</span>
            <span class="score-pill-value" id="highScore">0</span>
          </div>
        </div>

        <div class="quiz-footer">
          <button class="btn btn-outline" id="nextBtn">
            â–¶ æ¬¡ã®å•é¡Œ <span style="font-size:0.8rem; opacity:0.8;">ï¼ˆEnter âï¼‰</span>
          </button>
          <button class="btn btn-outline" id="finishBtn">â¹ çµ‚äº†ã—ã¦çµæœã‚’è¦‹ã‚‹</button>
        </div>
      </div>
    </div>

    <!-- æš—è¨˜ãƒšãƒ¼ã‚¸ -->
    <div class="card hidden" id="memoryScreen">
      <h2>æš—è¨˜ãƒšãƒ¼ã‚¸</h2>
      <p class="subtitle">ã‚«ãƒ†ã‚´ãƒªã”ã¨ã«ãƒ¡ãƒ‹ãƒ¥ãƒ¼ç•ªå·ã‚’ãƒã‚§ãƒƒã‚¯ï¼</p>

      <div class="memory-table-wrap">
        <table>
          <thead>
            <tr><th style="width:30%;">ç•ªå·</th><th>ãƒ¡ãƒ‹ãƒ¥ãƒ¼</th></tr>
          </thead>
          <tbody id="memoryTableBody"></tbody>
        </table>
      </div>

      <button class="btn btn-primary" style="margin-top:12px" onclick="setModeAndGo('normal')">
        ğŸ æ™®é€šãƒ¢ãƒ¼ãƒ‰ã§æ¤œå®š
      </button>
      <button class="btn btn-outline" style="margin-top:6px" onclick="setModeAndGo('hard')">
        ğŸ”¥ é›£é–¢ãƒ¢ãƒ¼ãƒ‰ã§æ¤œå®š
      </button>
      <button class="btn btn-outline" style="margin-top:6px" onclick="showScreen('homeScreen')">
        â¬… ãƒˆãƒƒãƒ—ã¸
      </button>
    </div>

    <!-- çµæœç”»é¢ -->
    <div class="card hidden" id="resultScreen">
      <div class="logo-title" style="margin-bottom:8px;">
        <span>çµæœç™ºè¡¨</span>
      </div>

      <div class="rank-badge" id="rankBadge">ãƒ©ãƒ³ã‚¯åˆ¤å®š</div>
      <div class="rank-title" id="rankTitle">ï¼Ÿï¼Ÿï¼Ÿç´š</div>
      <div class="rank-desc" id="rankDesc">çµæœã‚³ãƒ¡ãƒ³ãƒˆ</div>

      <div class="result-stats">
        <div><span>ãƒ¢ãƒ¼ãƒ‰</span><span id="statMode">æ™®é€šãƒ¢ãƒ¼ãƒ‰</span></div>
        <div><span>æ­£è§£æ•°</span><span id="statScore">0å•</span></div>
        <div><span>è§£ç­”æ•°</span><span id="statAnswered">0å•</span></div>
        <div><span>æ­£ç­”ç‡</span><span id="statRate">0%</span></div>
        <div><span>ãƒã‚¤ã‚¹ã‚³ã‚¢</span><span id="statHighScore">0å•</span></div>
      </div>

      <div class="share-hint">
        ã‚¹ã‚¯ã‚·ãƒ§ã—ã¦ <strong>#ã‚µã‚¤ã‚¼ãƒªãƒ¤æ¤œå®š</strong> ã‚’ã¤ã‘ã¦è‡ªæ…¢ã—ã‚ˆã†ï¼
      </div>

      <button class="btn btn-primary" id="retryBtn">ğŸ” åŒã˜ãƒ¢ãƒ¼ãƒ‰ã§ã‚‚ã†ä¸€åº¦</button>
      <button class="btn btn-outline" onclick="showScreen('memoryScreen')">ğŸ“– æš—è¨˜ãƒšãƒ¼ã‚¸ã¸</button>
      <button class="btn btn-outline" onclick="showScreen('homeScreen')">â¬… ãƒˆãƒƒãƒ—ã¸</button>
    </div>

  </div>

  <div id="starOverlay" class="star-overlay"></div>

  <script>
    const ALL_ITEMS = [
      { category:"å‰èœãƒ»ãŠã¤ã¾ã¿", name:"è¾›å‘³ãƒã‚­ãƒ³",number:1401 },
      { category:"å‰èœãƒ»ãŠã¤ã¾ã¿", name:"ã‚¢ãƒ­ã‚¹ãƒ†ã‚£ãƒãƒ¼ãƒ‹",number:1402 },
      { category:"å‰èœãƒ»ãŠã¤ã¾ã¿", name:"ã‚¢ãƒ­ã‚¹ãƒ†ã‚£ãƒãƒ¼ãƒ‹ Wã‚µã‚¤ã‚º",number:1452 },
      { category:"å‰èœãƒ»ãŠã¤ã¾ã¿", name:"ãƒãƒ§ãƒªã‚½ãƒ¼",number:1407 },
      { category:"å‰èœãƒ»ãŠã¤ã¾ã¿", name:"ãƒãƒƒãƒ—ã‚³ãƒ¼ãƒ³ã‚·ãƒ¥ãƒªãƒ³ãƒ—",number:1404 },
      { category:"å‰èœãƒ»ãŠã¤ã¾ã¿", name:"ã»ã†ã‚Œã‚“è‰ã®ã‚½ãƒ†ãƒ¼",number:1403 },
      { category:"å‰èœãƒ»ãŠã¤ã¾ã¿", name:"æŸ”ã‚‰ã‹é’è±†ã®æ¸©ã‚µãƒ©ãƒ€",number:1425 },
      { category:"å‰èœãƒ»ãŠã¤ã¾ã¿", name:"ã‚­ãƒ£ãƒ­ãƒƒãƒˆãƒ©ãƒš",number:1413 },
      { category:"å‰èœãƒ»ãŠã¤ã¾ã¿", name:"ã‚¨ã‚¹ã‚«ãƒ«ã‚´ã®ã‚ªãƒ¼ãƒ–ãƒ³ç„¼ã",number:1405 },
      { category:"å‰èœãƒ»ãŠã¤ã¾ã¿", name:"ãƒ ãƒ¼ãƒ«è²ã®ã‚¬ãƒ¼ãƒªãƒƒã‚¯ç„¼ã",number:1410 },
      { category:"å‰èœãƒ»ãŠã¤ã¾ã¿", name:"ãƒãƒ†ãƒˆã®ã‚°ãƒªãƒ«",number:1416 },
      { category:"å‰èœãƒ»ãŠã¤ã¾ã¿", name:"è’¸ã—é¶ã®é¦™å‘³ã‚½ãƒ¼ã‚¹",number:1408 },
      { category:"å‰èœãƒ»ãŠã¤ã¾ã¿", name:"ç”Ÿãƒãƒ ã¨ãƒãƒƒãƒ•ã‚¡ãƒ­ãƒ¼ãƒ¢ãƒƒãƒ„ã‚¡ãƒ¬ãƒ©ã®ç››ã‚Šåˆã‚ã›",number:1423 },
      { category:"å‰èœãƒ»ãŠã¤ã¾ã¿", name:"ãƒãƒ¢ãƒ³ã‚»ãƒ©ãƒ¼ãƒ",number:1422 },
      { category:"å‰èœãƒ»ãŠã¤ã¾ã¿", name:"ãƒãƒƒãƒ•ã‚¡ãƒ­ãƒ¼ãƒ¢ãƒƒãƒ„ã‚¡ãƒ¬ãƒ©ã®ã‚«ãƒ—ãƒ¬ãƒ¼ã‚¼",number:1417 },
      { category:"å‰èœãƒ»ãŠã¤ã¾ã¿", name:"å°ã‚¨ãƒ“ã®ã‚«ã‚¯ãƒ†ãƒ«",number:1406 },

      { category:"ã‚µãƒ©ãƒ€", name:"å°ã‚¨ãƒ“ã®ã‚µãƒ©ãƒ€",number:1202 },
      { category:"ã‚µãƒ©ãƒ€", name:"ãƒã‚­ãƒ³ã®ã‚µãƒ©ãƒ€",number:1209 },
      { category:"ã‚µãƒ©ãƒ€", name:"ã‚ã‹ã‚ã®ã‚µãƒ©ãƒ€",number:1205 },

      { category:"ã‚¹ãƒ¼ãƒ—", name:"ãŸã¾ã­ãã®ã‚ºãƒƒãƒ‘",number:1307 },
      { category:"ã‚¹ãƒ¼ãƒ—", name:"ã‚³ãƒ¼ãƒ³ã‚¯ãƒªãƒ¼ãƒ ã‚¹ãƒ¼ãƒ—",number:1301 },
      { category:"ã‚¹ãƒ¼ãƒ—", name:"ç”°èˆé¢¨ãƒŸãƒã‚¹ãƒˆãƒ­ãƒ¼ãƒ",number:1305 },

      { category:"ãƒ‰ãƒªã‚¢ãƒ»ã‚°ãƒ©ã‚¿ãƒ³", name:"ãƒŸãƒ©ãƒé¢¨ãƒ‰ãƒªã‚¢",number:2101 },
      { category:"ãƒ‰ãƒªã‚¢ãƒ»ã‚°ãƒ©ã‚¿ãƒ³", name:"åŠç†Ÿåµã®ãƒŸãƒ©ãƒé¢¨ãƒ‰ãƒªã‚¢",number:2103 },
      { category:"ãƒ‰ãƒªã‚¢ãƒ»ã‚°ãƒ©ã‚¿ãƒ³", name:"ç„¼ãƒãƒ¼ã‚ºãƒŸãƒ©ãƒé¢¨ãƒ‰ãƒªã‚¢",number:2108 },
      { category:"ãƒ‰ãƒªã‚¢ãƒ»ã‚°ãƒ©ã‚¿ãƒ³", name:"ã‚¿ãƒ©ã‚³ã¨ãƒãƒƒãƒ—ã‚³ãƒ¼ãƒ³ã‚·ãƒ¥ãƒªãƒ³ãƒ—ã®ãƒ‰ãƒªã‚¢",number:2110 },
      { category:"ãƒ‰ãƒªã‚¢ãƒ»ã‚°ãƒ©ã‚¿ãƒ³", name:"ãƒãƒƒãƒ—ã‚³ãƒ¼ãƒ³ã‚·ãƒ¥ãƒªãƒ³ãƒ—ã¨ã‚¿ãƒ©ã‚³ã®ã‚¯ãƒªãƒ¼ãƒ ã‚°ãƒ©ã‚¿ãƒ³",number:2115 },

      { category:"ãƒ”ã‚¶", name:"ãƒãƒƒãƒ•ã‚¡ãƒ­ãƒ¼ãƒ¢ãƒƒãƒ„ã‚¡ãƒ¬ãƒ©ã®ãƒãƒ«ã‚²ãƒªãƒ¼ã‚¿ãƒ”ã‚¶",number:2203 },
      { category:"ãƒ”ã‚¶", name:"ã‚½ãƒ¼ã‚»ãƒ¼ã‚¸ãƒ”ã‚¶",number:2208 },
      { category:"ãƒ”ã‚¶", name:"ãŸã£ã·ã‚Šã‚³ãƒ¼ãƒ³ã®ãƒ”ã‚¶",number:2206 },
      { category:"ãƒ”ã‚¶", name:"é‡èœã¨ãã®ã“ã®ãƒ”ã‚¶",number:2204 },

      { category:"ãƒ‘ã‚¹ã‚¿", name:"ã‚«ãƒ«ãƒœãƒŠãƒ¼ãƒ©",number:2305 },
      { category:"ãƒ‘ã‚¹ã‚¿", name:"ã‚¿ãƒ©ã‚³ã‚½ãƒ¼ã‚¹ã‚·ã‚·ãƒªãƒ¼é¢¨",number:2301 },
      { category:"ãƒ‘ã‚¹ã‚¿", name:"å°ã‚¨ãƒ“ã®ã‚¿ãƒ©ã‚³ã‚½ãƒ¼ã‚¹",number:2320 },
      { category:"ãƒ‘ã‚¹ã‚¿", name:"ãƒšãƒšãƒ­ãƒ³ãƒãƒ¼ãƒ",number:2303 },
      { category:"ãƒ‘ã‚¹ã‚¿", name:"ãƒšãƒ³ãƒã‚¢ãƒ©ãƒ“ã‚¢ãƒ¼ã‚¿",number:2325 },
      { category:"ãƒ‘ã‚¹ã‚¿", name:"ãƒŸãƒ¼ãƒˆã‚½ãƒ¼ã‚¹ãƒœãƒ­ãƒ‹ã‚¢é¢¨",number:2306 },
      { category:"ãƒ‘ã‚¹ã‚¿", name:"åŠç†Ÿåµã®ãƒŸãƒ¼ãƒˆã‚½ãƒ¼ã‚¹ãƒœãƒ­ãƒ‹ã‚¢é¢¨",number:2316 },
      { category:"ãƒ‘ã‚¹ã‚¿", name:"ã‚¹ãƒ¼ãƒ—å…¥ã‚Šå¡©å‘³ãƒœãƒ³ã‚´ãƒ¬",number:2310 },
      { category:"ãƒ‘ã‚¹ã‚¿", name:"ãƒ‘ãƒ«ãƒé¢¨ã‚¹ãƒ‘ã‚²ãƒƒãƒ†ã‚£",number:2304 },
      { category:"ãƒ‘ã‚¹ã‚¿", name:"ãã®ã“ã¨ã»ã†ã‚Œã‚“è‰ã®ã‚¯ãƒªãƒ¼ãƒ ã‚¹ãƒ‘ã‚²ãƒƒãƒ†ã‚£",number:2321 },
      { category:"ãƒ‘ã‚¹ã‚¿", name:"ã‚¤ã‚«ã®å¢¨å…¥ã‚Šã‚»ãƒ”ã‚¢ã‚½ãƒ¼ã‚¹",number:2328 },

      { category:"ã‚°ãƒªãƒ«ãƒ»è‚‰æ–™ç†", name:"ãƒŸãƒƒã‚¯ã‚¹ã‚°ãƒªãƒ«",number:2418 },
      { category:"ã‚°ãƒªãƒ«ãƒ»è‚‰æ–™ç†", name:"ãƒãƒ³ãƒãƒ¼ã‚°ã‚¹ãƒ†ãƒ¼ã‚­",number:2406 },
      { category:"ã‚°ãƒªãƒ«ãƒ»è‚‰æ–™ç†", name:"ã‚¤ã‚¿ãƒªã‚¢ãƒ³ãƒãƒ³ãƒãƒ¼ã‚°",number:2403 },
      { category:"ã‚°ãƒªãƒ«ãƒ»è‚‰æ–™ç†", name:"ãƒ‡ã‚£ã‚¢ãƒœãƒ©é¢¨ãƒãƒ³ãƒãƒ¼ã‚°",number:2407 },
      { category:"ã‚°ãƒªãƒ«ãƒ»è‚‰æ–™ç†", name:"è‹¥é¶ã®ãƒ‡ã‚£ã‚¢ãƒœãƒ©é¢¨",number:2402 },
      { category:"ã‚°ãƒªãƒ«ãƒ»è‚‰æ–™ç†", name:"æŸ”ã‚‰ã‹ãƒã‚­ãƒ³ã®ãƒãƒ¼ã‚ºç„¼ã",number:2404 },
      { category:"ã‚°ãƒªãƒ«ãƒ»è‚‰æ–™ç†", name:"ãƒ“ãƒ¼ãƒ•ã‚¹ãƒ†ãƒ¼ã‚­",number:2419 },

      { category:"ãƒ©ã‚¤ã‚¹", name:"ãƒ©ã‚¤ã‚¹",number:3101 },
      { category:"ãƒ©ã‚¤ã‚¹", name:"ãƒ©ãƒ¼ã‚¸ãƒ©ã‚¤ã‚¹",number:3102 },
      { category:"ãƒ©ã‚¤ã‚¹", name:"ã‚¹ãƒ¢ãƒ¼ãƒ«ãƒ©ã‚¤ã‚¹",number:3103 },

      { category:"ãƒ‡ã‚¶ãƒ¼ãƒˆ", name:"ã‚¤ã‚¿ãƒªã‚¢ãƒ³ãƒ—ãƒªãƒ³(ã™ãã«)",number:3201 },
      { category:"ãƒ‡ã‚¶ãƒ¼ãƒˆ", name:"ãƒ†ã‚£ãƒ©ãƒŸã‚¹ã‚¯ãƒ©ã‚·ã‚³(ã™ãã«)",number:3202 },
      { category:"ãƒ‡ã‚¶ãƒ¼ãƒˆ", name:"ãƒŸãƒ«ã‚¯ã‚¸ã‚§ãƒ©ãƒ¼ãƒˆ(ã™ãã«)",number:3203 },
      { category:"ãƒ‡ã‚¶ãƒ¼ãƒˆ", name:"ãƒãƒ§ã‚³ãƒ¬ãƒ¼ãƒˆã‚±ãƒ¼ã‚­(ã™ãã«)",number:3207 },
      { category:"ãƒ‡ã‚¶ãƒ¼ãƒˆ", name:"ãƒ—ãƒªãƒ³ã¨ãƒ†ã‚£ãƒ©ãƒŸã‚¹ã‚¯ãƒ©ã‚·ã‚³ã®ç››ã‚Šåˆã‚ã›(ã™ãã«)",number:3208 },
      { category:"ãƒ‡ã‚¶ãƒ¼ãƒˆ", name:"ãƒãƒ§ã‚³ãƒ¬ãƒ¼ãƒˆã‚±ãƒ¼ã‚­ï¼†ãƒŸãƒ«ã‚¯ã‚¸ã‚§ãƒ©ãƒ¼ãƒˆ(ã™ãã«)",number:3210 },
      { category:"ãƒ‡ã‚¶ãƒ¼ãƒˆ", name:"ãƒˆãƒªãƒ•ã‚¢ã‚¤ã‚¹ã‚¯ãƒªãƒ¼ãƒ (ã™ãã«)",number:3213 },
      { category:"ãƒ‡ã‚¶ãƒ¼ãƒˆ", name:"ã‚³ãƒ¼ãƒ’ãƒ¼ã‚¼ãƒªãƒ¼ï¼†ãƒŸãƒ«ã‚¯ã‚¸ã‚§ãƒ©ãƒ¼ãƒˆ(ã™ãã«)",number:3215 },
      { category:"ãƒ‡ã‚¶ãƒ¼ãƒˆ", name:"ã‚¸ã‚§ãƒ©ãƒ¼ãƒˆï¼†ã‚·ãƒŠãƒ¢ãƒ³ãƒ•ã‚©ãƒƒã‚«ãƒã‚ª(ã™ãã«)",number:3214 },

      { category:"ãƒ‰ãƒªãƒ³ã‚¯ãƒãƒ¼", name:"ã‚»ãƒƒãƒˆãƒ‰ãƒªãƒ³ã‚¯ãƒãƒ¼",number:5101 },
      { category:"ãƒ‰ãƒªãƒ³ã‚¯ãƒãƒ¼", name:"ã‚­ãƒƒã‚ºãƒ‰ãƒªãƒ³ã‚¯ãƒãƒ¼",number:5102 },
      { category:"ãƒ‰ãƒªãƒ³ã‚¯ãƒãƒ¼", name:"ãƒ‰ãƒªãƒ³ã‚¯ãƒãƒ¼å˜å“",number:5103 },

      { category:"ãƒˆãƒƒãƒ”ãƒ³ã‚°", name:"ãƒˆãƒƒãƒ”ãƒ³ã‚°ç²‰ãƒãƒ¼ã‚º",number:4307 },
      { category:"ãƒˆãƒƒãƒ”ãƒ³ã‚°", name:"ãƒˆãƒƒãƒ”ãƒ³ã‚°åŠç†Ÿåµ",number:4301},
      { category:"ãƒˆãƒƒãƒ”ãƒ³ã‚°", name:"ãƒˆãƒƒãƒ”ãƒ³ã‚°é‡èœã‚½ãƒ¼ã‚¹",number:4304 },

      { category:"ãƒ•ã‚©ãƒƒã‚«ãƒã‚ª", name:"ã‚¿ãƒ©ã‚³ãƒ•ã‚©ãƒƒã‚«ãƒã‚ª",number:3113 },
      { category:"ãƒ•ã‚©ãƒƒã‚«ãƒã‚ª", name:"ãƒãƒ¼ã‚ºãƒ•ã‚©ãƒƒã‚«ãƒã‚ª",number:3114 },
      { category:"ãƒ•ã‚©ãƒƒã‚«ãƒã‚ª", name:"ã‚¬ãƒ¼ãƒªãƒƒã‚¯ãƒ•ã‚©ãƒƒã‚«ãƒã‚ª",number:3111 },
      { category:"ãƒ•ã‚©ãƒƒã‚«ãƒã‚ª", name:"ãƒ•ã‚©ãƒƒã‚«ãƒã‚ª",number:3110 },
      { category:"ãƒ•ã‚©ãƒƒã‚«ãƒã‚ª", name:"ã‚·ãƒŠãƒ¢ãƒ³ãƒ•ã‚©ãƒƒã‚«ãƒã‚ª",number:3112 },

      { category:"ãƒ‡ã‚¶ãƒ¼ãƒˆ(å¾Œã§)", name:"ã‚¤ã‚¿ãƒªã‚¢ãƒ³ãƒ—ãƒªãƒ³(ã‚ã¨ã§)",number:3901 },
      { category:"ãƒ‡ã‚¶ãƒ¼ãƒˆ(å¾Œã§)", name:"ãƒ†ã‚£ãƒ©ãƒŸã‚¹ã‚¯ãƒ©ã‚·ã‚³(ã‚ã¨ã§)",number:3902 },
      { category:"ãƒ‡ã‚¶ãƒ¼ãƒˆ(å¾Œã§)", name:"ãƒŸãƒ«ã‚¯ã‚¸ã‚§ãƒ©ãƒ¼ãƒˆ(ã‚ã¨ã§)",number:3903 },
      { category:"ãƒ‡ã‚¶ãƒ¼ãƒˆ(å¾Œã§)", name:"ãƒãƒ§ã‚³ãƒ¬ãƒ¼ãƒˆã‚±ãƒ¼ã‚­(ã‚ã¨ã§)",number:3907 },
      { category:"ãƒ‡ã‚¶ãƒ¼ãƒˆ(å¾Œã§)", name:"ãƒ—ãƒªãƒ³ã¨ãƒ†ã‚£ãƒ©ãƒŸã‚¹ã‚¯ãƒ©ã‚·ã‚³ã®ç››ã‚Šåˆã‚ã›(ã‚ã¨ã§)",number:3908 },
      { category:"ãƒ‡ã‚¶ãƒ¼ãƒˆ(å¾Œã§)", name:"ãƒãƒ§ã‚³ãƒ¬ãƒ¼ãƒˆã‚±ãƒ¼ã‚­ï¼†ãƒŸãƒ«ã‚¯ã‚¸ã‚§ãƒ©ãƒ¼ãƒˆ(ã‚ã¨ã§)",number:3910 },
      { category:"ãƒ‡ã‚¶ãƒ¼ãƒˆ(å¾Œã§)", name:"ãƒˆãƒªãƒ•ã‚¢ã‚¤ã‚¹ã‚¯ãƒªãƒ¼ãƒ (ã‚ã¨ã§)",number:3913 },
      { category:"ãƒ‡ã‚¶ãƒ¼ãƒˆ(å¾Œã§)", name:"ã‚³ãƒ¼ãƒ’ãƒ¼ã‚¼ãƒªãƒ¼ï¼†ãƒŸãƒ«ã‚¯ã‚¸ã‚§ãƒ©ãƒ¼ãƒˆ(ã‚ã¨ã§)",number:3915 },
      { category:"ãƒ‡ã‚¶ãƒ¼ãƒˆ(å¾Œã§)", name:"ã‚¸ã‚§ãƒ©ãƒ¼ãƒˆï¼†ã‚·ãƒŠãƒ¢ãƒ³ãƒ•ã‚©ãƒƒã‚«ãƒã‚ª(ã‚ã¨ã§)",number:3914 },

      { category:"ãƒ¯ã‚¤ãƒ³", name:"ã‚°ãƒ©ã‚¹ãƒ¯ã‚¤ãƒ³(ç™½)",number:3402 },
      { category:"ãƒ¯ã‚¤ãƒ³", name:"ã‚°ãƒ©ã‚¹ãƒ¯ã‚¤ãƒ³(èµ¤)",number:3401 },
      { category:"ãƒ¯ã‚¤ãƒ³", name:"ãƒ‡ã‚«ãƒ³ã‚¿å°(ç™½)",number:3404 },
      { category:"ãƒ¯ã‚¤ãƒ³", name:"ãƒ‡ã‚«ãƒ³ã‚¿å°(èµ¤)",number:3403 },
      { category:"ãƒ¯ã‚¤ãƒ³", name:"ãƒ‡ã‚«ãƒ³ã‚¿å¤§(ç™½)",number:3406 },
      { category:"ãƒ¯ã‚¤ãƒ³", name:"ãƒ‡ã‚«ãƒ³ã‚¿å¤§(èµ¤)",number:3405 },
      { category:"ãƒ¯ã‚¤ãƒ³", name:"ãƒã‚°ãƒŠãƒ (ç™½)",number:3408 },
      { category:"ãƒ¯ã‚¤ãƒ³", name:"ãƒã‚°ãƒŠãƒ (èµ¤)",number:3407 },

      { category:"ãŠé…’", name:"ã‚¸ãƒ§ãƒƒã‚­",number:3301 },
      { category:"ãŠé…’", name:"ã‚°ãƒ©ã‚¹ãƒ“ãƒ¼ãƒ«",number:3302 },
      { category:"ãŠé…’", name:"ã‚¢ã‚µãƒ’ãƒ‰ãƒ©ã‚¤ã‚¼ãƒ­",number:3303 },
      { category:"ãŠé…’", name:"ã‚­ãƒªãƒ³æ°·çµã‚·ãƒãƒªã‚¢ç”£ãƒ¬ãƒ¢ãƒ³",number:3304 },
      { category:"ãŠé…’", name:"ã‚°ãƒ©ãƒƒãƒ‘",number:3306 },

      { category:"ãƒœãƒˆãƒ«ãƒ¯ã‚¤ãƒ³", name:"ãƒ‰ãƒ³ãƒ©ãƒ•ã‚¡ã‚¨ãƒ­",number:3413},
      { category:"ãƒœãƒˆãƒ«ãƒ¯ã‚¤ãƒ³", name:"ãƒ©ãƒ³ãƒ–ãƒ«ã‚¹ã‚³ãƒ­ã‚¼",number:3412},
      { category:"ãƒœãƒˆãƒ«ãƒ¯ã‚¤ãƒ³", name:"ãƒ©ãƒ³ãƒ–ãƒ«ã‚¹ã‚³ã‚»ãƒƒã‚³",number:3414},
      { category:"ãƒœãƒˆãƒ«ãƒ¯ã‚¤ãƒ³", name:"ãƒ™ãƒ«ãƒ‡ãƒƒã‚­ã‚ª",number:3415},
      { category:"ãƒœãƒˆãƒ«ãƒ¯ã‚¤ãƒ³", name:"ã‚­ãƒ£ãƒ³ãƒ†ã‚£",number:3416},
      { category:"ãƒœãƒˆãƒ«ãƒ¯ã‚¤ãƒ³", name:"ã‚­ãƒ£ãƒ³ãƒ†ã‚£ãƒ«ãƒ•ã‚£ãƒŠãƒªã‚¼ãƒ«ãƒ",number:3419}
    ];

    const NORMAL_EXCLUDED_CATEGORIES = new Set([
      "ãƒˆãƒƒãƒ”ãƒ³ã‚°","ãƒ¯ã‚¤ãƒ³","ãŠé…’","ãƒœãƒˆãƒ«ãƒ¯ã‚¤ãƒ³","ãƒ‡ã‚¶ãƒ¼ãƒˆ(å¾Œã§)"
    ]);
    const NORMAL_ITEMS = ALL_ITEMS.filter(
      item => !NORMAL_EXCLUDED_CATEGORIES.has(item.category)
    );

    let currentMode = "normal";

    const timeText = document.getElementById("timeText");
    const timeBarInner = document.getElementById("timeBarInner");
    const quizReady = document.getElementById("quizReady");
    const quizPlay = document.getElementById("quizPlay");
    const questionEl = document.getElementById("question");
    const answerInput = document.getElementById("answerInput");
    const resultEl = document.getElementById("result");
    const scoreEl = document.getElementById("score");
    const highScoreEl = document.getElementById("highScore");
    const nextBtn = document.getElementById("nextBtn");
    const finishBtn = document.getElementById("finishBtn");
    const startQuizBtn = document.getElementById("startQuizBtn");
    const comboText = document.getElementById("comboText");
    const quizCard = document.getElementById("quizScreen");
    const starOverlay = document.getElementById("starOverlay");
    const modeLabel = document.getElementById("modeLabel");
    const modeDetail = document.getElementById("modeDetail");

    const TOTAL_TIME = 60;
    let remainingTime = TOTAL_TIME;
    let timerId = null;
    let isPlaying = false;
    let currentItem = null;
    let currentList = NORMAL_ITEMS;
    let score = 0;
    let answeredCount = 0;
    let answeredThisQuestion = false;
    let comboCount = 0;
    let highScore = Number(localStorage.getItem("saizer_high_score") || 0);
    highScoreEl.textContent = highScore;

    function showScreen(id){
      ["homeScreen","quizScreen","memoryScreen","resultScreen"].forEach(s=>{
        document.getElementById(s).classList.add("hidden");
      });
      document.getElementById(id).classList.remove("hidden");
      if(id === "quizScreen"){
        resetQuizUI();
      }
    }

    function updateModeDetailText(){
      if(currentMode === "normal"){
        modeDetail.textContent =
          "â€» æ™®é€šãƒ¢ãƒ¼ãƒ‰ã§ã¯ã€Œãƒˆãƒƒãƒ”ãƒ³ã‚°ãƒ»ãƒ¯ã‚¤ãƒ³ãƒ»ãŠé…’ãƒ»ãƒœãƒˆãƒ«ãƒ¯ã‚¤ãƒ³ãƒ»ãƒ‡ã‚¶ãƒ¼ãƒˆ(å¾Œã§)ã€ã¯å‡ºé¡Œã•ã‚Œã¾ã›ã‚“ã€‚";
      } else {
        modeDetail.textContent =
          "â€» é›£é–¢ãƒ¢ãƒ¼ãƒ‰ã§ã¯å…¨ã‚«ãƒ†ã‚´ãƒªï¼ˆå‰èœãƒ»ãŠã¤ã¾ã¿ã€œãƒœãƒˆãƒ«ãƒ¯ã‚¤ãƒ³ã¾ã§ï¼‰ãŒå‡ºé¡Œã•ã‚Œã¾ã™ã€‚";
      }
    }

    function setModeAndGo(mode){
      currentMode = mode;
      modeLabel.textContent = (mode === "normal") ? "æ™®é€šãƒ¢ãƒ¼ãƒ‰" : "é›£é–¢ãƒ¢ãƒ¼ãƒ‰";
      updateModeDetailText();
      showScreen("quizScreen");
    }

    function resetQuizUI(){
      stopTimer();
      remainingTime = TOTAL_TIME;
      updateTimerUI();
      isPlaying = false;
      score = 0;
      answeredCount = 0;
      answeredThisQuestion = false;
      comboCount = 0;
      comboText.textContent = "";
      scoreEl.textContent = score;
      resultEl.textContent = "";
      resultEl.className = "";
      quizReady.classList.remove("hidden");
      quizPlay.classList.add("hidden");

      modeLabel.textContent = (currentMode === "normal") ? "æ™®é€šãƒ¢ãƒ¼ãƒ‰" : "é›£é–¢ãƒ¢ãƒ¼ãƒ‰";
      updateModeDetailText();
    }

    function startGame(){
      if(isPlaying) return;
      isPlaying = true;
      score = 0;
      answeredCount = 0;
      answeredThisQuestion = false;
      comboCount = 0;
      comboText.textContent = "";
      scoreEl.textContent = score;
      resultEl.textContent = "";
      resultEl.className = "";
      quizReady.classList.add("hidden");
      quizPlay.classList.remove("hidden");

      currentList = (currentMode === "normal") ? NORMAL_ITEMS : ALL_ITEMS;

      remainingTime = TOTAL_TIME;
      updateTimerUI();
      startTimer();
      pickRandomItem();
    }

    function startTimer(){
      stopTimer();
      timerId = setInterval(()=>{
        remainingTime--;
        if(remainingTime <= 0){
          remainingTime = 0;
          updateTimerUI();
          stopTimer();
          endGame();
        } else {
          updateTimerUI();
        }
      }, 1000);
    }

    function stopTimer(){
      if(timerId !== null){
        clearInterval(timerId);
        timerId = null;
      }
    }

    function updateTimerUI(){
      timeText.textContent = remainingTime + " ç§’";
      const ratio = remainingTime / TOTAL_TIME;
      timeBarInner.style.width = (ratio * 100) + "%";
      if(ratio <= 0.25){
        timeBarInner.style.background = "linear-gradient(90deg,#ff4d4d,#ffcf4d)";
      } else {
        timeBarInner.style.background = "linear-gradient(90deg,#1b9b5f,#ffcf4d)";
      }
    }

    function pickRandomItem(){
      if(!currentList || currentList.length === 0) return;
      const idx = Math.floor(Math.random() * currentList.length);
      currentItem = currentList[idx];
      questionEl.textContent = currentItem.name;
      questionEl.classList.remove("shake","pop");
      void questionEl.offsetWidth;
      questionEl.classList.add("pop");

      answerInput.value = "";
      answeredThisQuestion = false;
      resultEl.textContent = "";
      resultEl.className = "";
      answerInput.focus();
    }

    function showStars(){
      starOverlay.innerHTML = "";
      for(let i=0;i<3;i++){
        const span = document.createElement("span");
        span.textContent = "â˜…";
        span.className = "star";
        span.style.animationDelay = (i * 0.05) + "s";
        starOverlay.appendChild(span);
      }
      starOverlay.classList.add("show");
      setTimeout(()=>{
        starOverlay.classList.remove("show");
        starOverlay.innerHTML = "";
      }, 600);
    }

    function checkAnswer(){
      if(!isPlaying) return;
      if(!currentItem) return;
      if(answeredThisQuestion) return;

      const n = Number(answerInput.value);
      if(!n){
        resultEl.textContent = "ç•ªå·ã‚’å…¥åŠ›ã—ã¦ã­ï¼";
        resultEl.className = "";
        return;
      }

      answeredThisQuestion = true;
      answeredCount++;

      if(n === currentItem.number){
        score++;
        scoreEl.textContent = score;
        resultEl.textContent = "âœ… æ­£è§£ï¼";
        resultEl.className = "correct pop";

        comboCount++;
        if(comboCount >= 2){
          comboText.textContent = comboCount + "ã‚³ãƒ³ãƒœï¼";
          comboText.classList.remove("pop");
          void comboText.offsetWidth;
          comboText.classList.add("pop");
        } else {
          comboText.textContent = "";
        }

        showStars();
      } else {
        resultEl.textContent = "âŒ æ­£è§£ã¯ " + currentItem.number;
        resultEl.className = "wrong shake";

        comboCount = 0;
        comboText.textContent = "";

        quizCard.classList.remove("flash-red");
        void quizCard.offsetWidth;
        quizCard.classList.add("flash-red");
      }

      if(score > highScore){
        highScore = score;
        highScoreEl.textContent = score;
        localStorage.setItem("saizer_high_score", score);
      }
    }

    function endGame(){
      isPlaying = false;
      stopTimer();
      showResultScreen();
    }

    function getRank(score, mode){
  let grade, badge, desc;

  if(mode === "normal"){
    // æ™®é€šãƒ¢ãƒ¼ãƒ‰ï¼š6ç´šã€œ2ç´š
    if(score >= 21){
      grade = "2ç´š";
      badge = "ä¸Šç´šå¸¸é€£ã•ã‚“";
      desc = "åº—å“¡ã‚ˆã‚Šãƒ¡ãƒ‹ãƒ¥ãƒ¼è©³ã—ã„ã‹ã‚‚ã—ã‚Œãªã„ã‚¾ãƒ¼ãƒ³ã€‚ã‚‚ã†åæœ­ã¤ã‘ã¦ã„ã„ãƒ¬ãƒ™ãƒ«ã€‚";
    } else if(score >= 11){
      grade = "3ç´š";
      badge = "å¸¸é€£ã‚¯ãƒ©ã‚¹";
      desc = "ã€Œã¨ã‚Šã‚ãˆãšã‚µã‚¤ã‚¼è¡Œãï¼Ÿã€ã£ã¦è¨€ã„å‡ºã—ãŒã¡ãªå´ã®äººã€‚";
    } else if(score >= 6){
      grade = "4ç´š";
      badge = "é€šã„æ…£ã‚ŒãŸãŠå®¢ã•ã‚“";
      desc = "ã„ã¤ã‚‚ã®æ•°å“ã¯å®‰å®šã—ã¦å‡ºã¦ãã‚‹ã€‚ãã‚ãã‚å†’é™ºã—ã¦ã¿ã‚ˆï¼Ÿ";
    } else if(score >= 1){
      grade = "5ç´š";
      badge = "ãŠå®¢ã•ã‚“";
      desc = "å¥½ããªãƒ¡ãƒ‹ãƒ¥ãƒ¼ã¯è¦šãˆã¦ããŸã€‚ã‚ã¨ã¯â€œç•ªå·â€ã§é ¼ã‚€ã‚¯ã‚»ã¤ã‘ã‚ˆã€‚";
    } else {
      grade = "6ç´š";
      badge = "ã‚¹ã‚¿ãƒ¼ãƒˆãƒ©ã‚¤ãƒ³";
      desc = "ã‚µã‚¤ã‚¼æ¥ãŸã“ã¨ã¯â€¦ã‚ã‚‹ã‚ˆã­ï¼Ÿã¾ãšã¯ãƒ¡ãƒ‹ãƒ¥ãƒ¼è¡¨ã¨ä»²è‰¯ããªã‚ã†ã€‚";
    }
  } else {
    // é›£é–¢ãƒ¢ãƒ¼ãƒ‰ï¼š5ç´šã€œ1ç´š
    if(score >= 21){
      grade = "1ç´š";
      badge = "ã‚µã‚¤ã‚¼ãƒã‚¹ã‚¿ãƒ¼";
      desc = "ã“ã“ã¾ã§æ¥ã‚‹ã¨ã€Œã©ã“ã®åº—èˆ—å‹¤å‹™ã§ã™ã‹ï¼Ÿã€ã£ã¦èã‹ã‚Œã¦ã‚‚ãŠã‹ã—ããªã„ã€‚";
    } else if(score >= 11){
      grade = "2ç´š";
      badge = "ä¸Šç´šå¸¸é€£ã•ã‚“";
      desc = "ãƒ¯ã‚¤ãƒ³ã‚‚ãŠé…’ã‚‚ç•ªå·ã§å‡ºã¦ãã‚‹ã€‚å®Œå…¨ã«â€œé€šâ€ã®é ˜åŸŸã€‚";
    } else if(score >= 6){
      grade = "3ç´š";
      badge = "å¸¸é€£ã‚¯ãƒ©ã‚¹";
      desc = "é›£é–¢ãƒ¢ãƒ¼ãƒ‰ã§ã“ã®ã‚¹ã‚³ã‚¢ã¯æ™®é€šã«å¼·ã„ã€‚ã‚ã¨ä¸€æ­©ã§å¤‰æ…‹ãƒ¬ãƒ™ãƒ«ã€‚";
    } else if(score >= 1){
      grade = "4ç´š";
      badge = "é€šã„æ…£ã‚ŒãŸãŠå®¢ã•ã‚“";
      desc = "é›£é–¢ã«æ®´ã‚Šè¾¼ã¿ã«æ¥ãŸå‹‡è€…ã€‚çµæœã¯ã¨ã‚‚ã‹ãã€ãã®å¿ƒæ„æ°—ã¯è©•ä¾¡é«˜ã„ã€‚";
    } else {
      grade = "5ç´š";
      badge = "ãŠå®¢ã•ã‚“";
      desc = "ã¾ãšã¯æ™®é€šãƒ¢ãƒ¼ãƒ‰ã§è‚©æ…£ã‚‰ã—ã—ã‚ˆï¼Ÿã„ããªã‚Šãƒ©ã‚¹ãƒœã‚¹è¡Œã£ãŸæ„Ÿã˜ã€‚";
    }
  }

  return {
    title: (mode === "normal" ? "æ™®é€šãƒ¢ãƒ¼ãƒ‰ " : "é›£é–¢ãƒ¢ãƒ¼ãƒ‰ ") + grade,
    badge,
    desc
  };
}


    function showResultScreen(){
      const rank = getRank(score, currentMode);
      const rate = answeredCount > 0 ? Math.round((score/answeredCount)*100) : 0;

      document.getElementById("rankBadge").textContent = rank.badge;
      document.getElementById("rankTitle").textContent = rank.title;
      document.getElementById("rankDesc").textContent = rank.desc;

      document.getElementById("statMode").textContent =
        (currentMode === "normal") ? "æ™®é€šãƒ¢ãƒ¼ãƒ‰" : "é›£é–¢ãƒ¢ãƒ¼ãƒ‰";
      document.getElementById("statScore").textContent = score + "å•";
      document.getElementById("statAnswered").textContent = answeredCount + "å•";
      document.getElementById("statRate").textContent = rate + "%";
      document.getElementById("statHighScore").textContent = highScore + "å•";

      showScreen("resultScreen");
    }

    startQuizBtn.addEventListener("click", startGame);
    document.getElementById("submitBtn").addEventListener("click", checkAnswer);

    answerInput.addEventListener("keydown", (e) => {
      if (e.key === "Enter") {
        if (!answeredThisQuestion) {
          checkAnswer();
        } else {
          pickRandomItem();
        }
      }
    });

    nextBtn.addEventListener("click", ()=>{
      if(!isPlaying) return;
      pickRandomItem();
    });
    finishBtn.addEventListener("click", ()=>{
      if(isPlaying) endGame();
    });
    document.getElementById("retryBtn").addEventListener("click", ()=>{
      showScreen("quizScreen");
    });

    /* ===== æš—è¨˜è¡¨ï¼ˆã‚«ãƒ†ã‚´ãƒªã”ã¨ï¼‰ ===== */
const bodyEl = document.getElementById("memoryTableBody");
let lastCategory = "";
let hardSeparatorInserted = false; // ã€Œã“ã“ã‹ã‚‰é›£é–¢ãƒ¢ãƒ¼ãƒ‰ã€ã‚’1å›ã ã‘å…¥ã‚Œã‚‹ç”¨

ALL_ITEMS.forEach(item=>{
  // ã¾ã ã€Œã“ã“ã‹ã‚‰é›£é–¢ãƒ¢ãƒ¼ãƒ‰ã€ã‚’å…¥ã‚Œã¦ãªãã¦ã€
  // ã“ã®ã‚¢ã‚¤ãƒ†ãƒ ã®ã‚«ãƒ†ã‚´ãƒªãŒæ™®é€šãƒ¢ãƒ¼ãƒ‰ã‹ã‚‰é™¤å¤–ã•ã‚Œã¦ã„ã‚‹å ´åˆ
  if (!hardSeparatorInserted && NORMAL_EXCLUDED_CATEGORIES.has(item.category)) {
    const sepTr = document.createElement("tr");
    sepTr.className = "category-row";
    const sepTd = document.createElement("td");
    sepTd.colSpan = 2;
    sepTd.textContent = "ã“ã“ã‹ã‚‰é›£é–¢ãƒ¢ãƒ¼ãƒ‰";
    sepTr.appendChild(sepTd);
    bodyEl.appendChild(sepTr);
    hardSeparatorInserted = true;
  }

  // ã‚«ãƒ†ã‚´ãƒªã®è¦‹å‡ºã—è¡Œ
  if(item.category !== lastCategory){
    const catTr=document.createElement("tr");
    catTr.className="category-row";
    const catTd=document.createElement("td");
    catTd.colSpan=2;
    catTd.textContent=item.category;
    catTr.appendChild(catTd);
    bodyEl.appendChild(catTr);
    lastCategory=item.category;
  }

  // ãƒ¡ãƒ‹ãƒ¥ãƒ¼æœ¬ä½“
  const tr=document.createElement("tr");
  tr.innerHTML=`<td>${item.number}</td><td>${item.name}</td>`;
  bodyEl.appendChild(tr);
});

  </script>
</body>
</html>





